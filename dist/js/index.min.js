!function(){var t,e,n;!function(i){function o(t,e){return T.call(t,e)}function r(t,e){var n,i,o,r,s,a,l,c,u,d,h,f,m=e&&e.split("/"),p=b.map,g=p&&p["*"]||{};if(t){for(t=t.split("/"),s=t.length-1,b.nodeIdCompat&&C.test(t[s])&&(t[s]=t[s].replace(C,"")),"."===t[0].charAt(0)&&m&&(f=m.slice(0,m.length-1),t=f.concat(t)),u=0;u<t.length;u++)if("."===(h=t[u]))t.splice(u,1),u-=1;else if(".."===h){if(0===u||1===u&&".."===t[2]||".."===t[u-1])continue;u>0&&(t.splice(u-1,2),u-=2)}t=t.join("/")}if((m||g)&&p){for(n=t.split("/"),u=n.length;u>0;u-=1){if(i=n.slice(0,u).join("/"),m)for(d=m.length;d>0;d-=1)if((o=p[m.slice(0,d).join("/")])&&(o=o[i])){r=o,a=u;break}if(r)break;!l&&g&&g[i]&&(l=g[i],c=u)}!r&&l&&(r=l,a=c),r&&(n.splice(0,a,r),t=n.join("/"))}return t}function s(t,e){return function(){var n=x.call(arguments,0);return"string"!=typeof n[0]&&1===n.length&&n.push(null),m.apply(i,n.concat([t,e]))}}function a(t){return function(e){return r(e,t)}}function l(t){return function(e){v[t]=e}}function c(t){if(o(y,t)){var e=y[t];delete y[t],w[t]=!0,f.apply(i,e)}if(!o(v,t)&&!o(w,t))throw new Error("No "+t);return v[t]}function u(t){var e,n=t?t.indexOf("!"):-1;return n>-1&&(e=t.substring(0,n),t=t.substring(n+1,t.length)),[e,t]}function d(t){return t?u(t):[]}function h(t){return function(){return b&&b.config&&b.config[t]||{}}}var f,m,p,g,v={},y={},b={},w={},T=Object.prototype.hasOwnProperty,x=[].slice,C=/\.js$/;p=function(t,e){var n,i=u(t),o=i[0],s=e[1];return t=i[1],o&&(o=r(o,s),n=c(o)),o?t=n&&n.normalize?n.normalize(t,a(s)):r(t,s):(t=r(t,s),i=u(t),o=i[0],t=i[1],o&&(n=c(o))),{f:o?o+"!"+t:t,n:t,pr:o,p:n}},g={require:function(t){return s(t)},exports:function(t){var e=v[t];return void 0!==e?e:v[t]={}},module:function(t){return{id:t,uri:"",exports:v[t],config:h(t)}}},f=function(t,e,n,r){var a,u,h,f,m,b,T,x=[],C=typeof n;if(r=r||t,b=d(r),"undefined"===C||"function"===C){for(e=!e.length&&n.length?["require","exports","module"]:e,m=0;m<e.length;m+=1)if(f=p(e[m],b),"require"===(u=f.f))x[m]=g.require(t);else if("exports"===u)x[m]=g.exports(t),T=!0;else if("module"===u)a=x[m]=g.module(t);else if(o(v,u)||o(y,u)||o(w,u))x[m]=c(u);else{if(!f.p)throw new Error(t+" missing "+u);f.p.load(f.n,s(r,!0),l(u),{}),x[m]=v[u]}h=n?n.apply(v[t],x):void 0,t&&(a&&a.exports!==i&&a.exports!==v[t]?v[t]=a.exports:h===i&&T||(v[t]=h))}else t&&(v[t]=n)},t=e=m=function(t,e,n,o,r){if("string"==typeof t)return g[t]?g[t](e):c(p(t,d(e)).f);if(!t.splice){if(b=t,b.deps&&m(b.deps,b.callback),!e)return;e.splice?(t=e,e=n,n=null):t=i}return e=e||function(){},"function"==typeof n&&(n=o,o=r),o?f(i,t,e,n):setTimeout(function(){f(i,t,e,n)},4),m},m.config=function(t){return m(t)},t._defined=v,n=function(t,e,n){if("string"!=typeof t)throw new Error("See almond README: incorrect module build, no module name");e.splice||(n=e,e=[]),o(v,t)||o(y,t)||(y[t]=[t,e,n])},n.amd={jQuery:!0}}(),n("/Users/Arnaud/Sites/db-5/node_modules/almond/almond.js",function(){}),n("d1",[],function(){"use strict";var t=window,e=t.navigator,n={scrDensity:"devicePixelRatio"in t?t.devicePixelRatio:1,isTouch:"ontouchstart"in t||e.MaxTouchPoints>0||e.msMaxTouchPoints>0};return n.isIE9=function(){var t=e.userAgent.toLowerCase();return-1!==t.indexOf("msie")&&9===parseInt(t.split("msie")[1])},n.debounce=function(t,e,n){var i;return function(){var o=this,r=arguments;clearTimeout(i),i=setTimeout(function(){i=null,n||t.apply(o,r)},e),n&&!i&&t.apply(o,r)}},n.parent=function(t,e){e=e.toLowerCase();do{if(t.tagName.toLowerCase()===e)return t}while(t=t.parentNode);return null},n.elementArray=function(t){return Array.prototype.slice.call(t)},n.elementIndex=function(t){for(var e=0;t=t.previousElementSibling;)e++;return e},n}),function(t,e,i){"use strict";function o(t,e,n,i){return Math.round(-n*(t/=i)*(t-2)+e)}function r(t,e){var n=0;if(t.offsetParent)do{n+=t.offsetTop}while(t.offsetParent!=e&&(t=t.offsetParent));return n}function s(){u=0}function a(n){function i(){var r=Date.now();if(u&&r<=y)return w(o(r-g,m,p,v)),void t.requestAnimationFrame(i);u&&t.requestAnimationFrame(function(){w(f-(n.offset||0))}),"function"==typeof b&&b.call(a,u),a.removeEventListener(h,s),e.body.className=e.body.className.replace(d,"")}n=n||{};var a=n.context||t,f=n.to&&1===n.to.nodeType?r(n.to,a):n.to||0,m=a[n.context?"scrollTop":"pageYOffset"],p=f-(n.offset||0)-m,g=Date.now(),v=Math.abs(p/(n.speed||c)),y=g+v,b=n.callback,w=n.context?function(t){a.scrollTop=t}:function(t){a.scrollTo(0,t)};u=1,e.body.className+=" "+l,a.addEventListener(h,s),t.requestAnimationFrame(i)}var l="auto-scrolling",c=2,u=0,d=new RegExp("(?:^|\\s)"+l+"(?!\\S)","gi"),h="ontouchstart"in t||navigator.MaxTouchPoints>0||navigator.msMaxTouchPoints>0?"touchstart":"onwheel"in e.createElement("div")?"wheel":void 0!==e.onmousewheel?"mousewheel":"DOMMouseScroll";"function"==typeof n&&n.amd?n("goScroll",[],function(){return a}):"object"==typeof module&&module.exports?module.exports=a:window.goScroll=a}(window,document),n("app",["d1","goScroll"],function(t,e){"use strict";var n=window,i=n.document;return{util:t,initial:{},views:{},data:{},mail:["hello","dotburo","org"],resolution:Math.max(screen.width,screen.height)*t.scrDensity,hasHistory:n.history&&n.history.pushState&&void 0!==n.history.state,showingContact:0,initialize:function(t){this.initial=t,this.closeBtn=i.getElementById("btn-close"),this.contactBtn=i.getElementById("btn-contact"),this.track(),this.setSizable(),this.bindHandlers(),this.load()},bindHandlers:function(){var e=this;this.closeBtn.addEventListener("click",function(t){t.preventDefault(),e.closePage(1)}),this.contactBtn.addEventListener("click",function(t){e.toggleContact(t.currentTarget),t.preventDefault()}),n.addEventListener("resize",t.debounce(function(){e.setSizable()},200))},load:function(){var t=this;"complete"===i.readyState?t.onLoad():n.addEventListener("load",function(){t.onLoad()})},onLoad:function(){var t=this;t.insertMail(),t.wWidth<=780&&(this.navMobile=i.getElementById("nav-mobile"),this.navMobile.addEventListener("click",function(e){t.shiftPages(e)}))},insertMail:function(){var t=i.getElementById("mail"),e=i.createElement("a"),n=this.mail[0]+"@"+this.mail[1]+"."+this.mail[2],o=i.createTextNode(n);e.href="mailto:"+n,e.appendChild(o),t.appendChild(e)},setHistory:function(t){t.time=(new Date).getTime(),this.resetDocument(t),this.hasHistory&&n.history.pushState(t,t.title,t.url)},handlePopState:function(t){t.time=(new Date).getTime(),this.resetDocument(t),t.id?this.views.grid.launchPage(i.getElementById(t.id),t):this.closePage(0)},resetDocument:function(t){i.title="/"===t.url?this.initial.siteTitle:t.title+" • "+this.initial.siteTitle,n._paq&&(n._paq.push(["setGenerationTimeMs",0]),n._paq.push(["setCustomUrl",t.url]),n._paq.push(["setDocumentTitle",i.title]),n._paq.push(["trackPageView"]))},toggleCloseBtn:function(t,e){e&&(t=this.views.grid.activeColumn?1:0),this.closeBtn.classList[t?"remove":"add"]("hide")},closePage:function(t){this.toggleCloseBtn(0),this.views.grid.shrinkColumn(),t&&this.setHistory({id:null,title:this.initial.title,url:"/"})},toggleContact:function(t){var n,o=this;o.showingContact?(n=0,o.toggleCloseBtn(1,!0)):(n=i.getElementById("pages").clientHeight,o.toggleContactVisibility(1),this.toggleCloseBtn(0)),o.showingContact=!o.showingContact,e({to:n,speed:3,context:i.getElementById("pages"),callback:function(){o.showingContact?t.innerHTML="back":(o.toggleContactVisibility(0),t.innerHTML="contact")}})},toggleContactVisibility:function(t){i.getElementById("contact").parentNode.classList[t?"remove":"add"]("invisible")},shiftPages:function(t){var e,i=t.target;"button"===i.tagName.toLowerCase()&&(e=+i.getAttribute("data-id"),this.navMobile.querySelector(".active").classList.remove("active"),e!==this.currentPage&&(this.currentPage=e,this.toggleCloseBtn(0),this.views.grid.shrinkColumn(e+1),n.history.replaceState(this.initial,this.initial.siteTitle,"/"),this.views.grid.el.style.transform="translate3d(-"+25*e+"%,0,0)",i.classList.add("active")))},setSizable:function(){this.wWidth=n.innerWidth,this.gridWidth=this.views.grid.el.clientWidth},track:function(){var t="https://analytics.dotburo.org/",e=document,i=e.createElement("script"),o=e.getElementsByTagName("script")[0];i.type="text/javascript",i.async=!0,i.defer=!0,i.src=t+"piwik.js",n._paq=n._paq||[],n._paq.push(["trackPageView"]),n._paq.push(["enableLinkTracking"]),n._paq.push(["setTrackerUrl",t+"piwik.php"]),n._paq.push(["setSiteId","1"]),o.parentNode.insertBefore(i,o)}}}),n("templates",[],function(){return{allowImg:function(t){return t&&!/-posterframe\./.test(t)?t:null},main:function(t,e,n){return'<main data-slug="'+e+'"><article><h2>'+t+"</h2>"+(this.allowImg(n)?'<img src="'+n+'" alt="'+t+'">':"")+'<div class="xhr-root"><p class="about">Loading...</p></div></article></main>'},content:function(t){var e,n,i="",o="",r=[],s=0,a="",l=t.meta&&t.meta.media?t.meta.media:[],c=l.length;for(t.content&&(i='<div class="about">'+t.content+"</div>"),s;s<c;s++){if("string"==typeof l[s].src)o='<li><img src="'+l[s].src+'" alt="'+t.meta.title+'"></li>';else{for(n=0,e=l[s].src.length;n<e;n++)a+='<source src="'+l[s].src[n].url+'" type="'+l[s].src[n].mime+'">';o='<li><video controls preload poster="'+l[s].poster+'">'+a+"</video></li>"}r.push(o)}return i+"<ul>"+r.join("")+"</ul>"}}}),n("xhr",[],function(){var t=function(){var e=/^(?:application|text)\/xml/,n=/^application\/json/,i=function(t,i){return null==t&&(t=i.getResponseHeader("content-type")),e.test(t)?i.responseXML:n.test(t)&&""!==i.responseText?JSON.parse(i.responseText):i.responseText},o=function(t){return t.status>=200&&t.status<300||304===t.status||0===t.status&&"file:"===window.location.protocol},r=function(t,e,n,r){return function(){if(4===t.readyState){var s,a=t.status,l=i(e.headers&&e.headers.Accept,t);o(t)?(e.success&&e.success(l),n&&n(l)):(s=new Error("Server responded with a status of "+a),e.error&&e.error(t,a,s),r&&r(t))}}};return function(e){var n,i,o,s;if(null==e)throw new Error("You must provide options");null==e.type&&(e.type="GET"),s=new XMLHttpRequest;var a=t.Promise||"undefined"!=typeof Promise&&Promise,l=a&&new a(function(t,e){i=t,o=e});if(e.headers=e.headers||{},e.contentType&&(e.headers["Content-Type"]=e.contentType),"GET"===e.type&&"object"==typeof e.data){var c="";for(n in e.data)e.data.hasOwnProperty(n)&&(c+=function(t,e){return null==e?"":"&"+encodeURIComponent(t)+"="+encodeURIComponent(e)}(n,e.data[n]));if(c){var u=-1===e.url.indexOf("?")?"?":"&";e.url+=u+c.substring(1)}}s.onreadystatechange=r(s,e,i,o),s.open(e.type,e.url,!0);var d="*/".concat("*"),h={"*":d,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"};if(s.setRequestHeader("Accept",e.dataType&&h[e.dataType]?h[e.dataType]+("*"!==e.dataType?", "+d+"; q=0.01":""):h["*"]),e.headers)for(n in e.headers)e.headers.hasOwnProperty(n)&&s.setRequestHeader(n,e.headers[n]);return e.beforeSend&&e.beforeSend(s),s.send(e.data),l}}();return t}),n("gistHandle",[],function(){"use strict";function t(t){o["handleGist_"+t]=function(t){return function(i){n(i),e(i,t)}}(t)}function e(t,e){var n=r.querySelector('.gist[src*="'+e+'"]'),i=r.createElement("div");i.innerHTML=t.div,n.parentNode.insertBefore(i,n.nextSibling),n.parentNode.removeChild(n)}function n(t){if(t.stylesheet&&!r.querySelector('link[href="'+t.stylesheet+'"]')){var e=r.createElement("link"),n=r.getElementsByTagName("head")[0];e.type="text/css",e.rel="stylesheet",e.href=t.stylesheet,n.insertBefore(e,n.firstChild)}}function i(t){return t.split("/").pop().replace(/\.js$/,"")}var o=window,r=o.document;return o.handleGist=function(t){r.getElementsByClassName("gist")[0].innerHTML=t.div},function(e){var n=i(e),o=r.createElement("script");o.src="https://gist.github.com/"+n+".json?callback=handleGist_"+n,t(n),r.body.appendChild(o)}}),n("Page",["app","templates","xhr","gistHandle"],function(t,e,n,i){"use strict";var o=window,r=o.document,s=function(e,n){var i=e.el||this.getActiveItem(),r=i.id||"h"+(new Date).getTime(),s=i.getAttribute("href");e.id=i.id=r,e.slug=s,e.column=e.column||t.views.grid.getContentColumn(i),this.options=e,this.el=i,e.column.scrollTop=0,t.initial.isSingle&&t.initial.pageLoad?this.gaTrackVideo():(this.fetch(e,n),t.toggleCloseBtn(1)),n||t.initial.pageLoad?o._paq&&n.time&&(o._paq.push(["setGenerationTimeMs",n.time-(new Date).getTime()]),o._paq.push(["trackPageView"])):t.setHistory({id:r,title:this.getTitle(e.el),url:s})};return s.prototype={getActiveItem:function(){var t=r.querySelector(".open main").getAttribute("data-slug"),e=r.querySelector('a.item[href="'+t+'"]');return e&&e.classList.add("active"),e},getTitle:function(t){return t.getAttribute("data-title")||t.getElementsByTagName("h2")[0].textContent},fetch:function(i,o){var r=this;if(this.options.column.innerHTML=e.main(this.el.getAttribute("data-title"),i.slug,this.el.getAttribute("data-img")),o)return this.render(t.data[i.id]);n({url:i.slug.replace(/\/$/,"")+"?get",success:function(e){e.errors&&(e.content='<p class="err-xhr"> ¡SERVER ERROR &mdash; NO DATA RETRIEVED! </p>'),t.data[i.id]=e,r.render(e)},error:function(t,e,n){r.render({content:'<p class="err-xhr"> ¡NETWORK ERROR ['+e+"] &mdash; "+n.toString().toUpperCase()+"! </p>"})}})},render:function(t){var n=this.options.column.getElementsByClassName("xhr-root")[0];n.innerHTML=e.content(t),this.evalGists(n),this.gaTrackVideo()},evalGists:function(e){var n=e.getElementsByClassName("gist");t.util.elementArray(n).forEach(function(t){i(t.src)})},destroy:function(){this.options.column.innerHTML=""},gaTrackVideo:function(){var t=this.options.column.getElementsByTagName("video"),e=t.length,n=0,i={},r={},s=function(){r[this.currentSrc]||(o.ga("send","event","Videos","Play",this.currentSrc),r[this.currentSrc]=1)},a=function(){var t=this.currentTime;!i[this.currentSrc]&&t>.75*this.duration&&(o.ga("send","event","Videos","Watched 75%",this.currentSrc),i[this.currentSrc]=1)};for(n;n<e;n++)t[n].addEventListener("play",s),t[n].addEventListener("timeupdate",a)}},s}),n("Grid",["app","Page"],function(t,e){"use strict";var n=window,i=n.document,o=t.util.isTouch,r=!1,s=0,a=function(t,e){if(!r){var i=this;n.requestAnimationFrame(function(){i.showHoverImage(t,e)})}r=!0},l=function(t){var e=t.el.querySelectorAll("a.item, .blog a");this.el=t.el,this.thumb=i.getElementById("thumb"),this.activeColumn=i.querySelector(".col.open"),this.bindHandlers(e),this.onTransitionEnd("width")};return l.prototype={bindHandlers:function(t){var e,i=this,r=0,s=t.length,l=function(t){if("_blank"===t.currentTarget.target)return!0;t.preventDefault(),t.currentTarget.classList.contains("active")?n.history.back():(i.hideThumb(),i.launchPage(t.currentTarget))},c=function(t){a.call(i,t,this)},u=function(){i.hideThumb()};for(r;r<s;r++)t[r].addEventListener("click",l),(e=t[r].getAttribute("data-img"))&&!o&&(i.preloadImage(e),t[r].addEventListener("mousemove",c),t[r].addEventListener("mouseleave",u));o||i.thumb.addEventListener("mouseenter",u)},preloadImage:function(t){(new Image).src=t},showHoverImage:function(t,e){var n=e.getAttribute("data-img");this.thumb.style.top=t.pageY+"px",this.thumb.style.left=t.pageX+"px",s!==n&&this.setThumb(n),r=!1},setThumb:function(t){s=t,this.thumb.style.display="block",this.thumb.innerHTML='<img src="'+t+'" width="150px">'},hideThumb:function(){s=0,this.thumb.style.display="none"},onTransitionEnd:function(t){var e=this;this.el.addEventListener("transitionend",function(n){n.propertyName===t&&(e.activeColumn?e.onColumnExpanded(n.target):e.onColumnShrunk(n.target))})},launchPage:function(i,o){var r=this,s=r.getContentColumn(i),a=/(blog)/.test(i.href)?"blog":s.id;switch(this.unsetActiveItem(),i.classList.add("active"),r.activeColumn=s,r.activeColumnIndex=t.util.elementIndex(s),t.views.page=new e({el:i,column:s},o),a){case"online":r.shiftGrid(s),r.expandColumn(s);break;case"offline":r.shiftGrid(s),n.setTimeout(function(){r.expandColumn(s)},250);break;case"blog":r.expandColumn(s,1),n.setTimeout(function(){r.shiftGrid(s,1)},200)}},getContentColumn:function(e){var n=t.util.parent(e,"section");return i.getElementById(n.getAttribute("data-id"))},expandColumn:function(t,e){t.classList.remove("invisible"),n.requestAnimationFrame(function(){e?t.classList.add("open","as-blog"):(t.classList.remove("as-blog"),t.classList.add("open"))})},shiftGrid:function(e,i){var o=this,r=0;if(t.wWidth>=780){switch(e.id){case"online":r=0;break;case"offline":r=i?2:1}r=Math.ceil(t.gridWidth*(11*r)/100)}else r=o.mobileGridShift();n.requestAnimationFrame(function(){o.el.style.transform="translate3d(-"+r+"px,0,0)"})},mobileGridShift:function(){var e=this.activeColumnIndex>1?this.activeColumnIndex-1:1;return Math.ceil(t.gridWidth*(25*e)/100)},onColumnExpanded:function(){this.toggleColumnVisibility(0)},shrinkColumn:function(e){var i=this,o=i.activeColumn;o&&(o.classList.remove("open"),i.unsetActiveItem(),i.toggleColumnVisibility(1),n.requestAnimationFrame(function(){var n;o.classList.remove("open"),t.wWidth>=780?i.el.style.transform="translate3d(0,0,0)":(i.activeColumnIndex=e||i.activeColumnIndex,n=1===i.activeColumnIndex?0:Math.ceil(25*t.gridWidth/100),i.el.style.transform="translate3d(-"+n+"px,0,0)"),i.activeColumn=null,i.activeColumnIndex=null}))},unsetActiveItem:function(){var t=i.querySelector("a.item.active");t&&t.classList.remove("active")},onColumnShrunk:function(e){n.requestAnimationFrame(function(){e.classList.add("invisible"),t.views.page.destroy(),delete t.views.page})},toggleColumnVisibility:function(e){var n=t.util.elementArray(i.getElementsByClassName("col")),o=this.activeColumnIndex-1,r=0;for(n.splice(o,2),r;r<n.length;r++);}},l}),function(t){"use strict";var n=t.document,i=t.location,o=i.pathname;e.config({baseUrl:"/resources/js",paths:{xhr:"vendor/xhr",goScroll:"vendor/goScroll",d1:"modules/d1",app:"app",templates:"modules/pageTpl",Grid:"modules/Grid",Page:"modules/Page",gistHandle:"modules/gist-handle"}}),e(["app","Grid","Page"],function(e,r,s){var a=!t.navigator.platform.match(/(Mac|iPhone|iPod|iPad)/i),l={pageLoad:1,isSingle:"/"!==o&&"/index.php"!==o&&!n.getElementsByClassName(".err-404").length,siteTitle:n.getElementById("site-title").getAttribute("content"),title:n.title,url:i.href};a&&n.body.classList.add("is-win"),n.body.classList.add(e.util.isTouch?"is-touch":"no-touch"),e.hasHistory&&(t.addEventListener("popstate",function(t){t.state&&e.handlePopState(t.state)}),t.history.replaceState(l,l.title,l.url)),e.views.grid=new r({el:n.getElementById("grid")}),e.initialize(l),l.isSingle&&(e.views.page=new s({}),e.views.grid.shiftGrid(n.querySelector(".col.open"),/(blog)/.test(o)),e.views.grid.onColumnExpanded()),e.initial.pageLoad=0})}(window),n("index.js",function(){})}();
//# sourceMappingURL=index.min.js.map